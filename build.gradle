plugins {
    id 'java'
    id 'antlr'
    id 'com.github.sherter.google-java-format' version '0.8'
    id 'idea'
    id 'eclipse'
}

repositories {
    jcenter()
}

sourceCompatibility = 10
targetCompatibility = 10

dependencies {
    antlr 'org.antlr:antlr4:4.7.1'

    testImplementation 'org.junit.jupiter:junit-jupiter-api:5.3.1'
    testImplementation 'org.junit.jupiter:junit-jupiter-params:5.3.1'

    testImplementation 'com.fasterxml.jackson.core:jackson-databind:2.9.7'
    testImplementation 'com.fasterxml.jackson.dataformat:jackson-dataformat-yaml:2.9.7'

    testImplementation 'org.skyscreamer:jsonassert:1.5.0'

    testImplementation 'com.google.guava:guava:27.0-jre'

    testRuntime 'org.junit.jupiter:junit-jupiter-engine:5.3.1'
}

generateGrammarSource {
    arguments += ['-no-listener', '-package', 'com.github.agmcc.slate.antlr']
    outputDirectory = new File("$buildDir/generated-src/antlr/main/com/github/agmcc/slate/antlr")
}

test {
    useJUnitPlatform()
    testLogging {
        events 'failed', 'standard_error'
        exceptionFormat = 'full'
    }
}

task format {
    dependsOn ':googleJavaFormat'
    group 'build'
    description 'Google Java Format'
}
